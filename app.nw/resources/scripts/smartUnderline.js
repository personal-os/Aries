// smartUnderline.js
// @IdeasNeverCease
// ========================================================
// SmartUnderline 3.0.0
// Eager Platform Co. (https://github.com/EagerIO/SmartUnderline)
// MIT licensed

(function(){var e,n,t,r,i,o,a,l,d,u,m,c,s,g,f,p,h,v,b,y,k,x,w,S,C,A,z,E,L,M,H,T,I,N;window.SmartUnderline={init:function(){},destroy:function(){}},window.getComputedStyle&&document.documentElement.getAttribute&&(e=1.618034,M="#50bebf",w="data-smart-underline-link-color",z="data-smart-underline-link-small",A="data-smart-underline-link-large",k="data-smart-underline-link-always",x="data-smart-underline-link-background-position",C="data-smart-underline-link-hover",a="data-smart-underline-container-id",E=[],I=function(){return+new Date},S={},N=function(){var e;return e=0,function(){return e+=1}}(),o=function(e,n){return n.clearRect(0,0,e.width,e.height)},r=function(e,n,t){var r,i,a,l,d,u,m,c,s,g;for(o(n,t),t.fillStyle="red",d=t.measureText(e).width,t.fillText(e,0,0),i=void 0,u=c=0;d>=0?d>=c:c>=d;u=d>=0?++c:--c)for(m=s=0,g=n.height;g>=0?g>=s:s>=g;m=g>=0?++s:--s)a=t.getImageData(u,m,u+1,m+1),l=a.data[0],r=a.data[3],255===l&&r>50&&(i||(i=m),m>i&&(i=m));return o(n,t),i},i=function(e){var n,t,i,o,a;return t=document.createElement("canvas"),i=t.getContext("2d"),t.height=t.width=2*parseInt(e.fontSize,10),i.textBaseline="top",i.textAlign="start",i.fontStretch=1,i.angle=0,i.font=""+e.fontVariant+" "+e.fontStyle+" "+e.fontWeight+" "+e.fontSize+"/"+e.lineHeight+" "+e.fontFamily,n=r("I",t,i),a=r("g",t,i),o=a-n,{baselineY:n,descenderHeight:o}},t=function(e){var n,t,r,i,o,a,l,d;return d=document.createElement("div"),d.style.display="block",d.style.position="absolute",d.style.bottom=0,d.style.right=0,d.style.width=0,d.style.height=0,d.style.margin=0,d.style.padding=0,d.style.visibility="hidden",d.style.overflow="hidden",a=document.createElement("span"),i=document.createElement("span"),a.style.display="inline",i.style.display="inline",a.style.fontSize="0px",i.style.fontSize="2000px",a.innerHTML="X",i.innerHTML="X",d.appendChild(a),d.appendChild(i),e.appendChild(d),l=a.getBoundingClientRect(),o=i.getBoundingClientRect(),e.removeChild(d),n=l.top-o.top,r=o.height,t=Math.abs(n/r)},n={},f=function(r){var o,a,l,d,u,m,c,s,g,f,p,h,v,b,y;return g=getComputedStyle(r),c="font:"+g.fontFamily+"size:"+g.fontSize+"weight:"+g.fontWeight,(m=n[c])?m:(y=i(g),d=y.baselineY,f=y.descenderHeight,s=r.getClientRects(),(null!=s?s.length:void 0)?(o=1,b=s[0].height-o,-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&(o=.98,u=t(r),d=u*b*o),p=d+f,h=parseInt(g.fontSize,10),v=3,a=d+Math.max(v,f/e),4===f&&(a=p-1),3===f&&(a=p),l=Math.round(100*a/b),f>2&&h>10&&100>=l?(n[c]=l,l):void 0):void 0)},y=function(e){var n,t;return"transparent"===e||"rgba(0, 0, 0, 0)"===e?!0:(t=e.match(/^rgba\(.*,(.+)\)/i),2===(null!=t?t.length:void 0)&&(n=parseFloat(t[1]),1e-4>n)?!0:!1)},s=function(e){var n,t,r,i;return t=getComputedStyle(e),n=t.backgroundColor,r=e.parentNode,i=!r||r===document.documentElement||r===e,"none"!==t.backgroundImage?null:y(n)?i?e.parentNode||e:s(r):e},p=function(e){return d(e)||l(e)},d=function(e){var n,t,r,i,o,a;for(i=e.children,t=0,r=i.length;r>t;t++)return n=i[t],"img"===(o=null!=(a=n.tagName)?a.toLowerCase():void 0)||"video"===o||"canvas"===o||"embed"===o||"object"===o||"iframe"===o?!0:d(n);return!1},l=function(e){var n,t,r,i,o;for(o=e.children,r=0,i=o.length;i>r;r++)return n=o[r],t=getComputedStyle(n),"inline"!==t.display?!0:l(n);return!1},c=function(e){var n;return n=getComputedStyle(e).backgroundColor,e===document.documentElement&&y(n)?"rgb(255, 255, 255)":n},g=function(e){return getComputedStyle(e).color},T=document.createElement("style"),u=function(e,n){var t,r;return null==n&&(n=0),t=e.parentNode,r=!t||t===document||t===e,r?n:(t.hasAttribute(a)&&(n+=1),n+u(t))},H=function(e){var n,t,r;r=[];for(t in e)n=e[t],n.depth=u(n.container),r.push(n);return r.sort(function(e,n){return e.depth<n.depth?-1:e.depth>n.depth?1:0}),r},v=function(e){var n,t,r,i,o;return o=getComputedStyle(e),r=parseFloat(o.fontSize),"underline"===o.textDecoration&&"inline"===o.display&&r>=10&&!p(e)&&(t=s(e),t&&(n=f(e)))?(e.setAttribute(w,g(e)),e.setAttribute(x,n),i=t.getAttribute(a),i?S[i].links.push(e):(i=N(),t.setAttribute(a,i),S[i]={id:i,container:t,links:[e]}),!0):!1},L=function(){var e,n,t,r,i,o,l,d,u,m,s,p,h,v,b;for(m="",i=H(S),l={},s=0,h=i.length;h>s;s++){for(r=i[s],d={},b=r.links,p=0,v=b.length;v>p;p++)o=b[p],d[g(o)]=!0,l[f(o)]=!0;e=c(r.container);for(t in d)u=function(e){return null==e&&(e=""),"["+a+'="'+r.id+'"] a['+w+'="'+t+'"]['+k+"]"+e+",\n["+a+'="'+r.id+'"] a['+w+'="'+t+'"]['+C+"]"+e+":hover"},m+=""+u()+", "+u(":visited")+" {\n  color: "+t+";\n  text-decoration: none !important;\n  text-shadow: 0.03em 0 "+e+", -0.03em 0 "+e+", 0 0.03em "+e+", 0 -0.03em "+e+", 0.06em 0 "+e+", -0.06em 0 "+e+", 0.09em 0 "+e+", -0.09em 0 "+e+", 0.12em 0 "+e+", -0.12em 0 "+e+", 0.15em 0 "+e+", -0.15em 0 "+e+";\n  background-color: transparent;\n  background-image: -webkit-linear-gradient("+e+", "+e+"), -webkit-linear-gradient("+e+", "+e+"), -webkit-linear-gradient("+t+", "+t+");\n  background-image: -moz-linear-gradient("+e+", "+e+"), -moz-linear-gradient("+e+", "+e+"), -moz-linear-gradient("+t+", "+t+");\n  background-image: -o-linear-gradient("+e+", "+e+"), -o-linear-gradient("+e+", "+e+"), -o-linear-gradient("+t+", "+t+");\n  background-image: -ms-linear-gradient("+e+", "+e+"), -ms-linear-gradient("+e+", "+e+"), -ms-linear-gradient("+t+", "+t+");\n  background-image: linear-gradient("+e+", "+e+"), linear-gradient("+e+", "+e+"), linear-gradient("+t+", "+t+");\n  -webkit-background-size: 0.05em 1px, 0.05em 1px, 1px 1px;\n  -moz-background-size: 0.05em 1px, 0.05em 1px, 1px 1px;\n  background-size: 0.05em 1px, 0.05em 1px, 1px 1px;\n  background-repeat: no-repeat, no-repeat, repeat-x;\n}\n\n"+u("::selection")+" {\n  text-shadow: 0.03em 0 "+M+", -0.03em 0 "+M+", 0 0.03em "+M+", 0 -0.03em "+M+", 0.06em 0 "+M+", -0.06em 0 "+M+", 0.09em 0 "+M+", -0.09em 0 "+M+", 0.12em 0 "+M+", -0.12em 0 "+M+", 0.15em 0 "+M+", -0.15em 0 "+M+";\n  background: "+M+";\n}\n\n"+u("::-moz-selection")+" {\n  text-shadow: 0.03em 0 "+M+", -0.03em 0 "+M+", 0 0.03em "+M+", 0 -0.03em "+M+", 0.06em 0 "+M+", -0.06em 0 "+M+", 0.09em 0 "+M+", -0.09em 0 "+M+", 0.12em 0 "+M+", -0.12em 0 "+M+", 0.15em 0 "+M+", -0.15em 0 "+M+";\n  background: "+M+";\n}"}for(n in l)m+="a["+x+'="'+n+'"] {\n  background-position: 0% '+n+"%, 100% "+n+"%, 0% "+n+"%;\n}";return T.innerHTML=m},b=function(){var e,n,t;return n=this,e=n.hasAttribute(C),!e&&(t=v(n))?(n.setAttribute(C,""),L()):void 0},h=function(e){var n,t,r,i,o,a;if(i=I(),t=document.querySelectorAll(""+(e.location?e.location+" ":"")+"a"),t.length){for(S={},o=0,a=t.length;a>o;o++)n=t[o],r=v(n),r?n.setAttribute(k,""):(n.removeEventListener("mouseover",b),n.addEventListener("mouseover",b));return L(),document.body.appendChild(T),E.push(I()-i)}},m=function(){var e,n,t,r,i,o;for(null!=(r=T.parentNode)&&r.removeChild(T),Array.prototype.forEach.call(document.querySelectorAll("["+C+"]"),function(e){return e.removeEventListener(b)}),i=[w,z,A,k,C,a],o=[],n=0,t=i.length;t>n;n++)e=i[n],o.push(Array.prototype.forEach.call(document.querySelectorAll("["+e+"]"),function(n){return n.removeAttribute(e)}));return o},window.SmartUnderline={init:function(e){return null==e&&(e={}),"loading"===document.readyState?(window.addEventListener("DOMContentLoaded",function(){return h(e)}),window.addEventListener("load",function(){return m(),h(e)})):(m(),h(e))},destroy:function(){return m()},performanceTimes:function(){return E}})}).call(this);